{% extends "homepage_base.html" %}

{% load url from future %}
{% load i18n %}
{% load content_utils %}
{% load account_tags %}
{% load pagination_tags %}
{% load staticfiles %}

{% block body %}
<br><br> 
<div class="row">
	<div class="span6 offset1">
		<h2>{% trans "Answer questions" %}</h2>
		{% if category_name %}<h5>{% trans "Category" %} {{ category_name }}</h5>{% endif %}
		<form class="navbar-search form-horizontal" action="" method="POST">{% csrf_token %}
            <span>
                <input type="text" autocomplete="off" class="typeahead span2 search-query" name="select_category" id="global_search_cat" placeholder="{% trans 'Filter by category' %}">
                <button type="submit" class="btn btn-primary">{% trans "Select" %}</button>
            </span> 
        </form>
		<br><br><br>
		<hr>
	</div>
</div>


<div class="row"><div class="offset1 span10">{% if object_list %}{% for content in object_list %}
    
    {% include "items/feed_display/_question.html" with display="unanswered" %}
    {% if content.items.all %}
	    {% for item in content.items.all %}
	    <div class="span1 content-item-mini">
		{% include "items/feed_display/_image.html" with image=item.image display="unanswered_questions" %}
	    </div>
	    {% endfor %}

    {% endif %}
{% endfor %}
{% else %}
{% trans "No unanswered questions on this category." %}
<h3><a href="{% url 'item_create' 'question' %}" class="btn btn-large">{% trans "Ask your own awesome question then!" %}</a></h3>
{% endif %}
</div></div>
{% if is_paginated %}{% paginate %}{% endif %}

{% endblock %}

{% block extra_script %}
    {{ block.super }}
    <script type="text/javascript">
        $(function() {
            var labels, mapped
            $("#global_search_cat").typeahead({
                source: function (query, process) {
                    $.get('{% url "redis" "tags" %}', {q: query}, function (data) {
                        labels = []
                        mapped = {}

                        $.each(data, function (i, item) {
                            mapped[item.title] = item
                            labels.push(item.title)
                        })
                        process(labels)
                    })
                }
            });
        });
    </script>
{% endblock %}