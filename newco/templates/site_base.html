{% extends "theme_bootstrap/base.html" %}

{% load url from future %}
{% load metron_tags %}
{% load i18n %}
{% load staticfiles %}
{% load account_tags %}
{% load compress %}

{% block style_base %}
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" rel="stylesheet">
    <link rel="icon" href="{% static 'img/favicon.png' %}" type="image/png" />
    <link rel="shortcut icon" href="{% static 'favicon.ico' %}" />
    {% compress css %}
        <link href="{% static 'external/select2/select2.css' %}" rel="stylesheet">
        <link href="{{ STATIC_URL }}external/joyride/joyride-2.0.3.css" rel="stylesheet">
        <link href="{% static 'css/global.css' %}" rel="stylesheet">
        {% include "feedback/header.html" %}
        <!--
            We may need to use font-awesome. Won't replace glyphicons for the moment
            due to bad pixel fitting of small icons.
            <link rel="stylesheet" href="{% static "css/font-awesome.css" %}">
        -->
    {% endcompress %}
    {% compress css %}
        {% block extra_style %}{% endblock %}
    {% endcompress %}
{% endblock %}

{% block extra_head_base %}
    {% compress js %}
    <script src="{% static 'js/ga.js' %}"></script>
    <script>var var_mixpanel="{{ MIXPANEL_KEY_ID }}";</script>
    <script src="{% static 'js/mixpanel.js' %}"></script>
    {% block extra_head_script %}{% endblock%}
    {% endcompress %}
{% endblock %}

{% block navbar_class %}navbar-fixed-top navbar-inverse{% endblock %}

{% block nav %}
<ul class="nav pull-left">
  <li class="offset1 span4"><form class="navbar-search form-search" action="{% url 'search' %}" method="POST">{% csrf_token %}
    <div class="input-append">
      <input class="span4 search-query" name="q" id="global_search" type="text" autocomplete="off" placeholder="{% trans 'Search for a product, a user or a tag' %}"><button class="btn btn-inverse" type="submit"><i class="icon-search icon-white"></i></button>
    </div>
    <input id="obj_class" name="obj_class" type="hidden">
    <input id="obj_id" name="obj_id" type="hidden">
  </form></li>
</ul>
{% endblock %}

{% block footer %}{% include "_footer.html" %}{% endblock %}


{% block script_base %}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js"></script>
    {% compress js %}
        <script src="{% static 'pinax/js/theme.js' %}"></script>
        <script src="{% static 'external/select2/select2.js' %}"></script>
        <script src="{{ STATIC_URL }}external/joyride/jquery.joyride-2.0.3.js"></script>
        <script src="{{ STATIC_URL }}external/jquery-expander/jquery.expander.min.js"></script>
        <script src="{{ STATIC_URL }}external/masonry/jquery.masonry.min.js"></script>
        <script src="{{ STATIC_URL }}js/modernizr-csstransitions.min.js"></script>
        <script src="{{ STATIC_URL }}jsi18n/{{ LANGUAGE_CODE }}/djangojs.js"></script>
        <script src="{{ STATIC_URL }}js/utils.js"></script>
        <script>
          var URL_REDIS = "{{ URL_REDIS }}";
          var URL_REDIS_TAG = "{{ URL_REDIS_TAG }}";
          var URL_REDIS_PROFILE = "{{ URL_REDIS_PROFILE }}";
          var user = JSON.parse(htmlDecode("{{ user_json }}"))
        </script>
        <script src="{% static 'js/global.js' %}"></script>
        <script src="{% static 'js/mixpanel_functions.js' %}"></script>
        <script src="{{ STATIC_URL }}js/voting.js"></script>
    {% endcompress %}
    {% compress js %}
        {% block extra_script %}{% endblock %}
    {% endcompress %}
{% endblock %}

{% block extra_body_base %}
  <ol class="hidden" id="joyRideContent">
    <li data-class="brand" data-button="{% trans 'Tell me more!' %}">
      <p>{% trans "NewCo is a product information webapp organized around Q&amp;A." %}</p>
    </li>
    <li data-id="global_search" data-button="{% trans 'But what if I don&#39;t find it?' %}">
      <p>{% trans "Looking for some information or advice? See if you can find here the related product, tag or user." %}</p>
    </li>
    <li data-id="add-dropdown" data-button="{% trans 'Thank you!' %}">
      <p>{% trans "NewCo is a collaborative webapp: if you can't find what you're looking for, create it and ask something!" %}</p>
    </li>
    {% comment %}
      Seb: excluded until a solution to avoid the "tip" to go out of the window is found
      <li data-class="non_auth" data-button="{% trans "Next" %}">
        <p>{% trans "Sign up to build your reputation with your contributions." %}</p>
      </li>
    {% endcomment %}
  </ol>
  {% if launch_tutorial %}
    <script>$.launchJoyride();</script>
  {% endif %}

  <!-- To remove -->
  <div class="hidden" id="mixpanel_identity"{% if user.is_authenticated %} data-user_id="{{ request.user.id }}" data-email="{{ request.user.email }}" data-created="{{ request.user.date_joined }}" data-name="{% user_display request.user %}" data-bio="{{ user.get_profile.about }}" data-reputation="{{ user.reputation.reputation_incremented }}"{% endif %}>
  </div>
  {% analytics %}

  {% block extra_body %}{% endblock %}

  {% include "feedback/button.html" %}
{% endblock %}
