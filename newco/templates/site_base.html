{% extends "theme_bootstrap/base.html" %}

{% load url from future %}
{% load metron_tags %}
{% load i18n %}
{% load staticfiles %}
{% load account_tags %}
{% load compress %}

{% block style_base %}
    <link href="{% static "pinax/css/theme.css" %}" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <!--
    <link href="{% static "bootstrap/css/bootstrap.css" %}" rel="stylesheet">
    <link href="{% static "bootstrap/css/bootstrap-responsive.css" %}" rel="stylesheet">
    -->
    <link rel="icon" href="{% static 'img/favicon.png' %}" type="image/png" />
    <link rel="shortcut icon" href="{% static 'favicon.ico' %}" />
    {% compress css %}
        <link href="{% static 'external/select2/select2.css' %}" rel="stylesheet">
        <link href="{% static 'css/joyride-2.0.2.css' %}" rel="stylesheet">
        <link href="{% static 'css/global.css' %}" rel="stylesheet">
        {% include "feedback/header.html" %}
        <!--
            We may need to use font-awesome. Won't replace glyphicons for the moment
            due to bad pixel fitting of small icons.
            <link rel="stylesheet" href="{% static "css/font-awesome.css" %}">
        -->
        {% block extra_style %}
        {% endblock %}
    {% endcompress %}
{% endblock %}

{% block extra_head_base %}
    {% compress js %}
    {{ block.super }}
    <script type="text/javascript" src="{% static 'js/ga.js' %}"></script>
    <script type="text/javascript">var var_mixpanel="{{ MIXPANEL_KEY_ID }}";</script>
    <script type="text/javascript" src="{% static 'js/mixpanel.js' %}"></script>
    {% block extra_head_script %}{% endblock%}
    {% endcompress %}
{% endblock %}

{% block navbar_class %}navbar-fixed-top navbar-inverse{% endblock %}

{% block nav %}
<ul class="nav pull-left">
  <li class="offset1 span4"><form class="navbar-search form-search" action="{% url 'search' %}" method="POST">{% csrf_token %}
    <div class="input-append">
      <input type="text" autocomplete="off" class="span4 search-query" name="q" id="global_search" placeholder="{% trans 'Search for a product, a user or a tag' %}"><button type="submit" class="btn btn-inverse"><i class="icon-search icon-white"></i></button>
    </div>
    <input type="hidden" id="obj_class" name="obj_class"/>
    <input type="hidden" id="obj_id" name="obj_id"/>
  </form></li>
</ul>
{% endblock %}

{% block footer %}{% include "_footer.html" %}{% endblock %}


{% block script_base %}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js"></script>
    {% compress js %}
        <script src="{% static 'pinax/js/theme.js' %}"></script>
        <script src="{% static 'js/jquery.masonry.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jquery.joyride-2.0.2.js' %}"></script>
        {% if not visited and not '/dashboard' in request.path and not '/about/' in request.path and not 'account/' in request.path %} {# Seb: exclude "/about" temporarily because pages are generated with "direct_to_template()" => no way to use TutoMixin... #}<script type="text/javascript">
          $(window).load(function() {
              launchJoyride();
          });
        </script>{% endif %}
        <script src="{% static 'external/select2/select2.js' %}"></script>
        <script>
          var URL_TYPEAHEAD='{% url "redis" %}';
          var URL_REDIS_TAG='{% url "redis" "tag" %}'
        </script>
        <script src="{% static 'js/global.js' %}"></script>
        <script src="{% static 'js/expand.js' %}"></script>
        <script src="{% static 'js/mixpanel_functions.js' %}"></script>
        {% block extra_script %}
        {% endblock %}
    {% endcompress %}
{% endblock %}

{% block extra_body_base %}
  {{ block.super }}

  <ol id="joyRideContent" style="display:none">
    <li data-class="brand" data-button="{% trans "Tell me more!" %}">
      <p>{% trans "NewCo is a product information webapp organized around Q&amp;A." %}</p>
    </li>
    <li data-id="global_search" data-button="{% trans "... what if I don&#39;t find?" %}">
      <p>{% trans "Find what you are looking for by product, tag, question or user." %}</p>
    </li>
    <li data-id="add-dropdown" data-button="{% trans "Thank you!" %}">
      <p>{% trans "NewCo is a collaborative webapp:" %}<br>{% trans "If you don't find, ask!" %}{#<br>{% trans "...and help others when you know the answer ;)" %}</p>#}
    </li>{% comment %} Seb: excluded until a solution to avoid the "tip" to go out of the window is found
    <li data-class="non_auth" data-button="{% trans "Next" %}">
      <p>{% trans "Sign up to build your reputation with your contributions." %}</p>
    </li>{% endcomment %}
  </ol>

  <div class="no-display" id="mixpanel_identity"{% if user.is_authenticated %} data-user_id="{{ request.user.id }}" data-email="{{ request.user.email }}" data-created="{{ request.user.date_joined }}" data-name="{% user_display request.user %}" data-bio="{{ user.get_profile.about }}" data-reputation="{{ user.reputation.reputation_incremented }}"{% endif %}>
  </div>
  {% analytics %}

  {% block extra_body %}{% endblock %}

  {% include "feedback/button.html" %}
{% endblock %}
